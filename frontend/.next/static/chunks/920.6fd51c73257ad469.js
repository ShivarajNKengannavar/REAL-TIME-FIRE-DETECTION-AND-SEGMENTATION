(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[920],{8920:function(e,t,r){"use strict";r.r(t);var a=r(5893),n=r(7294),o=r(5243),l=r.n(o);r(6904);var c=r(8029),i=r(8491),s=r(2206);t.default=e=>{let{incidents:t}=e,r=(0,n.useRef)(null),o=(0,n.useRef)(null),[u,d]=(0,n.useState)(null),[p,h]=(0,n.useState)(""),[m,g]=(0,n.useState)(null),[b,f]=(0,n.useState)("prompt");(0,n.useEffect)(()=>{if(!o.current){o.current=l().map(r.current).setView([12.9716,77.5946],13),l().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"\xa9 OpenStreetMap contributors"}).addTo(o.current);let e={OpenStreetMap:l().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"),"Light Mode":l().tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"),"Dark Mode":l().tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png")};l().control.layers(e).addTo(o.current)}if(o.current){o.current.eachLayer(e=>{(e instanceof l().Marker||e instanceof l().LayerGroup)&&o.current.removeLayer(e)});let e=t.filter(e=>"number"==typeof e.lat&&"number"==typeof e.lon&&!isNaN(e.lat)&&!isNaN(e.lon));if(e.forEach(e=>{let t=e.risk_level>.7?"red":e.risk_level>.3?"orange":"green",r=l().divIcon({className:"custom-div-icon",html:'<div style="background-color: '.concat(t,'; width: 10px; height: 10px; border-radius: 50%; border: 2px solid white;"></div>'),iconSize:[10,10],iconAnchor:[5,5]});l().marker([e.lat,e.lon],{icon:r}).bindPopup("\n            <b>".concat(e.location_name,"</b><br>\n            Risk Level: ").concat((100*e.risk_level).toFixed(1),"%<br>\n            Time: ").concat(e.timestamp,"<br>\n            Zone: ").concat(e.zone_type,"\n          ")).addTo(o.current)}),e.length>0){let t=e.map(e=>[e.lat,e.lon,e.risk_level]);l().heatLayer(t,{radius:25,blur:15,maxZoom:10,max:1,gradient:{.4:"blue",.6:"yellow",.8:"orange",1:"red"}}).addTo(o.current)}navigator.geolocation&&"live"===b&&navigator.geolocation.getCurrentPosition(e=>{let{latitude:t,longitude:r}=e.coords;d([t,r]),o.current.setView([t,r],13),l().marker([t,r]).addTo(o.current)},()=>{alert("Could not get your location")})}},[t,b]);let handleLocationSearch=async()=>{if(!p.trim())return;let e=await fetch("https://nominatim.openstreetmap.org/search?format=json&q=".concat(p)),t=await e.json();if(t&&t[0]){let{lat:e,lon:r}=t[0];d([parseFloat(e),parseFloat(r)]),o.current.setView([e,r],13),m&&o.current.removeLayer(m);let a=l().marker([e,r]).addTo(o.current);g(a)}else alert("Location not found")};return(0,a.jsxs)(c.x,{h:"100%",w:"100%",children:["prompt"===b&&(0,a.jsxs)(c.x,{mb:4,children:[(0,a.jsx)(i.z,{onClick:()=>f("live"),colorScheme:"green",mr:4,children:"Use My Current Location"}),(0,a.jsx)(i.z,{onClick:()=>f("manual"),colorScheme:"blue",children:"Enter Location Manually"})]}),"manual"===b&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.I,{value:p,onChange:e=>h(e.target.value),placeholder:"Enter a location",size:"lg",mb:4}),(0,a.jsx)(i.z,{onClick:handleLocationSearch,colorScheme:"blue",mb:4,children:"Search Location"})]}),(0,a.jsx)(c.x,{ref:r,h:"500px",w:"100%"})]})}},6904:function(){}}]);